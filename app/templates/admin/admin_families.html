{% extends "base.html" %}

{% block content %}

<div class="customdiv">
    <h1>Admin - Families</h1>
</div>

<div class="customdiv">
    <h2>View all families</h2>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Family Name</th>
                <th>Invite Code</th>
            </tr>
        </thead>

        <tbody>
            {% for family in families %}
                <tr>
                    <td>{{ family.id }}</td>
                    <td>{{ family.name }}</td>
                    <td>{{ family.invitation_code }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="customdiv">
    <h2>View all family members</h2>

    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Family ID</th>
                <th>Family Name</th>
                <th>User ID</th>
                <th>User Name</th>
                <th>Family Role</th>
            </tr>
        </thead>

        <tbody>
            {% for family_member in family_members %}
                <tr>
                    <td>{{ family_member.id }}</td>
                    <td>{{ family_member.family_id }}</td>
                    <td>{{ family_member.family.name }}</td>
                    <td>{{ family_member.user_id }}</td>
                    <td>{{ family_member.user.username }}</td>
                    <td>{{ family_member.role_in_family }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Add Family Form -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow-lg">
                <div class="card-body p-4">
                    <div class="customdiv">
                        <h2>Add Family</h2>
                        <!-- Add Family Form -->
                        <form method="POST" action="{{ url_for('admin.add_family') }}">
                            {{ create_family_form.hidden_tag() }}
                            <div class="mb-3">
                                {{ create_family_form.family_name.label(class="form-label") }}
                                {{ create_family_form.family_name(class="form-control") }}
                            </div>
                            {{ create_family_form.submit(class="btn btn-primary w-100") }}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add User to Family -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow-lg">
                <div class="card-body p-4">
                    <div class="customdiv">
                        <h2>Add User to Family</h2>
                        <!-- Add User to Family Form -->
                        <form method="POST" action="{{ url_for('admin.add_user_to_family') }}">
                            {{ add_user_form.hidden_tag() }}
                            <div class="mb-3">
                                {{ add_user_form.family_id.label(class="form-label") }}
                                {{ add_user_form.family_id(class="form-select") }}
                            </div>

                            <div class="mb-3">
                                {{ add_user_form.user_id.label(class="form-label") }}
                                {{ add_user_form.user_id(class="form-select") }}
                            </div>

                            <div class="mb-3">
                                {{ add_user_form.role_in_family.label(class="form-label") }}
                                {{ add_user_form.role_in_family(class="form-select") }}
                            </div>

                            {{ add_user_form.submit(class="btn btn-primary w-100") }}
                        </form>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Delete Family -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow-lg">
                <div class="card-body p-4">
                    <div class="customdiv">
                        <h2>Delete Family</h2>
                        <form method="POST" action="{{ url_for('admin.delete_family') }}">
                            {{ delete_family_form.hidden_tag() }}
                            <div class="mb-3">
                                {{ delete_family_form.family_id.label(class="form-label") }}
                                {{ delete_family_form.family_id(class="form-select") }}
                            </div>
                            {{ delete_family_form.submit(class="btn btn-danger w-100") }}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Reassign Family Owner -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card shadow-lg">
                <div class="card-body p-4">
                    <div class="customdiv">
                        <h2>Reassign Family Owner</h2>
                        <form method="POST" action="{{ url_for('admin.reassign_family_owner') }}">
                            {{ transfer_family_form.hidden_tag() }}
                            <div class="mb-3">
                                {{ transfer_family_form.family_id.label(class="form-label") }}
                                {{ transfer_family_form.family_id(class="form-select") }}
                            </div>
                            <div class="mb-3">
                                {{ transfer_family_form.new_owner_id.label(class="form-label") }}
                                {{ transfer_family_form.new_owner_id(class="form-select") }}
                            </div>
                            {{ transfer_family_form.submit(class="btn btn-warning w-100") }}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<br>
                
<div>
    <a href="{{ url_for('admin.admin_home') }}" class="btn btn-primary">Go back</a>

</div>


{% endblock %}